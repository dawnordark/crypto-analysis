<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- ... [head部分保持不变] ... -->
    <style>
        /* 新增阻力位显示样式 */
        .resistance-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        .resistance-block {
            flex: 1;
            min-width: 120px;
            border-radius: 6px;
            padding: 8px;
            text-align: center;
        }
        .block-header {
            font-size: 12px;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .resistance-value {
            font-weight: bold;
            font-size: 13px;
            margin: 3px 0;
        }
        .support-value {
            font-weight: bold;
            font-size: 13px;
            margin: 3px 0;
        }
        .resistance-display {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
        }
        
        /* 优化状态标签显示 */
        .period-status {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 12px;
        }
        .status-tag {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            min-width: 40px;
        }
        
        /* 优化币种项布局 */
        .coin-item {
            padding: 12px;
        }
        .coin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <!-- ... [前面的HTML保持不变] ... -->
    
    <!-- 阻力位查询区域 -->
    <div class="resistance-query">
        <div class="resistance-header" @click="toggleCollapse('resistance')">
            <div class="resistance-title">阻力位/支撑位查询</div>
            <span class="collapse-icon">{{ collapsedSections.resistance ? '►' : '▼' }}</span>
        </div>
        <div class="query-container">
            <input 
                type="text" 
                class="query-input" 
                placeholder="输入币种简称 (如 BTC)"
                v-model="resistanceQuery"
                @input="formatSymbolInput"
                @keyup.enter="queryResistanceLevels"
            >
            <button 
                class="query-btn" 
                @click="queryResistanceLevels"
                :disabled="queryLoading"
            >
                查询
            </button>
        </div>

        <!-- 优化后的阻力位显示 -->
        <div v-if="queryResult && !collapsedSections.resistance" class="resistance-result">
            <div class="resistance-display">
                <div class="resistance-row">
                    <div class="resistance-block">
                        <div class="block-header">阻力位</div>
                        <div v-for="(level, idx) in queryResult.levels.resistance" :key="'resistance'+idx" 
                             class="resistance-value">
                            {{ level.toFixed(4) }}
                        </div>
                        <div v-if="queryResult.levels.resistance.length === 0" class="resistance-value">
                            无数据
                        </div>
                    </div>
                    <div class="resistance-block">
                        <div class="block-header">支撑位</div>
                        <div v-for="(level, idx) in queryResult.levels.support" :key="'support'+idx" 
                             class="support-value">
                            {{ level.toFixed(4) }}
                        </div>
                        <div v-if="queryResult.levels.support.length === 0" class="support-value">
                            无数据
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 币种项中的阻力位显示 -->
    <div v-if="resistanceExpanded[coin.symbol]" class="resistance-display">
        <div v-if="resistanceData[coin.symbol]">
            <div class="resistance-row">
                <div class="resistance-block">
                    <div class="block-header">阻力位</div>
                    <div v-for="(level, idx) in resistanceData[coin.symbol].resistance" :key="'resistance'+idx" 
                         class="resistance-value">
                        {{ level.toFixed(4) }}
                    </div>
                    <div v-if="resistanceData[coin.symbol].resistance.length === 0" class="resistance-value">
                        无数据
                    </div>
                </div>
                <div class="resistance-block">
                    <div class="block-header">支撑位</div>
                    <div v-for="(level, idx) in resistanceData[coin.symbol].support" :key="'support'+idx" 
                         class="support-value">
                        {{ level.toFixed(4) }}
                    </div>
                    <div v-if="resistanceData[coin.symbol].support.length === 0" class="support-value">
                        无数据
                    </div>
                </div>
            </div>
        </div>
        <div v-else class="loading">
            <span class="loading-spinner"></span> 加载阻力位数据中...
        </div>
    </div>
    
    <script>
        // ... [Vue代码中修改以下方法] ...
        
        methods: {
            // 获取阻力位数据（简化逻辑）
            getResistanceLevels(symbol) {
                return this.resistanceData[symbol] || { resistance: [], support: [] };
            },
            
            // 查询阻力位
            queryResistanceLevels() {
                if (!this.resistanceQuery) return;
                
                const symbol = this.resistanceQuery.toUpperCase() + 'USDT';
                this.queryLoading = true;
                
                axios.get(`/api/resistance_levels/${symbol}`)
                    .then(response => {
                        this.queryResult = {
                            symbol: symbol,
                            levels: response.data
                        };
                        this.queryLoading = false;
                    })
                    .catch(error => {
                        console.error('阻力位查询失败:', error);
                        this.queryResult = {
                            symbol: symbol,
                            levels: { resistance: [], support: [] }
                        };
                        this.queryLoading = false;
                    });
            },
            
            // 其他方法保持不变...
        }
    </script>
</body>
</html>
